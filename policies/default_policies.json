{
  "policies": [
    {
      "id": "SEC-001",
      "description": "No hardcoded credentials (passwords, API keys) in code",
      "type": "strict",
      "severity": "high",
      "check": {
        "type": "regex",
        "pattern": "(?i)(password|api[_-]?key|secret|token|credential)\\s*=\\s*['\"][^'\"]*[a-zA-Z0-9]{4,}[^'\"]*['\"](?!\\s*#.*env)",
        "languages": ["python", "javascript"],
        "exclude_patterns": ["os\\.getenv", "os\\.environ", "process\\.env", "getenv\\(", "environ\\.get"]
      },
      "fix_suggestion": "Use environment variables or secure vault for credentials"
    },
    {
      "id": "SEC-002",
      "description": "Do not log or print sensitive information (like passwords)",
      "type": "strict",
      "severity": "medium",
      "check": {
        "type": "ast",
        "function": "find_print_of_variable",
        "target": "password|secret|key",
        "languages": ["python"]
      },
      "fix_suggestion": "Remove sensitive data from logging statements"
    },
    {
      "id": "INPUT-001",
      "description": "All user inputs must be validated or sanitized",
      "type": "defeasible",
      "severity": "high",
      "check": {
        "type": "manual",
        "message": "Check if user input is used in dangerous context without validation",
        "languages": ["python", "javascript"]
      },
      "fix_suggestion": "Add input validation using type checks, regex, or sanitization functions",
      "exceptions": [
        {
          "condition": "internal_trusted_source",
          "description": "Input from authenticated internal services with schema validation"
        },
        {
          "condition": "type_safe_deserialization",
          "description": "Input deserialized through type-safe framework (e.g., Pydantic, TypeScript)"
        }
      ]
    },
    {
      "id": "SEC-003",
      "description": "Dangerous functions (eval, exec) are disallowed",
      "type": "strict",
      "severity": "critical",
      "check": {
        "type": "regex",
        "pattern": "\\beval\\(|\\bexec\\(",
        "languages": ["python", "javascript"]
      },
      "fix_suggestion": "Replace eval/exec with safer alternatives like ast.literal_eval or JSON.parse"
    },
    {
      "id": "SEC-004",
      "description": "Use secure communication (HTTPS instead of HTTP)",
      "type": "strict",
      "severity": "high",
      "check": {
        "type": "regex",
        "pattern": "http://(?!localhost|127\\.0\\.0\\.1)",
        "languages": ["python", "javascript"]
      },
      "fix_suggestion": "Replace HTTP URLs with HTTPS"
    },
    {
      "id": "ERR-001",
      "description": "Exceptions should be caught and handled; do not expose stack traces",
      "type": "defeasible",
      "severity": "medium",
      "check": {
        "type": "manual",
        "message": "Check for proper exception handling without exposing internals",
        "languages": ["python", "javascript"]
      },
      "fix_suggestion": "Add try/except blocks and return user-friendly error messages",
      "exceptions": [
        {
          "condition": "debug_mode",
          "description": "Stack traces allowed when DEBUG=true for development"
        }
      ]
    },
    {
      "id": "LOG-001",
      "description": "Do not log sensitive user data (PII, credentials, financial info)",
      "type": "defeasible",
      "severity": "medium",
      "check": {
        "type": "regex",
        "pattern": "log.*\\b(user_id|email|password|card|ssn|credit)\\b",
        "languages": ["python", "javascript"]
      },
      "fix_suggestion": "Mask or remove sensitive data from log statements",
      "exceptions": [
        {
          "condition": "audit_requirement",
          "description": "Audit logging for PCI-DSS, SOX, HIPAA compliance"
        },
        {
          "condition": "secure_audit_storage",
          "description": "Logging to encrypted, access-controlled audit store"
        }
      ]
    },
    {
      "id": "SQL-001",
      "description": "Use parameterized queries instead of string concatenation for SQL",
      "type": "strict",
      "severity": "critical",
      "check": {
        "type": "regex",
        "pattern": "(SELECT|INSERT|UPDATE|DELETE).*\\+.*|f['\"].*SELECT",
        "languages": ["python"]
      },
      "fix_suggestion": "Use parameterized queries with prepared statements"
    },
    {
      "id": "CRYPTO-001",
      "description": "Do not use weak cryptographic algorithms (MD5, SHA1)",
      "type": "strict",
      "severity": "high",
      "check": {
        "type": "regex",
        "pattern": "hashlib\\.(md5|sha1)\\(",
        "languages": ["python"]
      },
      "fix_suggestion": "Use SHA-256 or stronger hashing algorithms"
    }
  ]
}
